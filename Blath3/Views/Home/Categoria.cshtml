
@{
    //ViewBag.Title = "Categoria";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section header{
    <script>



        $(document).ready(function () {


            var selEmpsName = [];
            var selEmpsId = [];
            var qtdsel = -1;
            var selEmpresas = "<li>Não há empresas selecionadas</li>";

            //getUrlParameter('action');
            //init Paginacao
            var pag = 1;
            var regpag = 3;
            Paginacao(pag);

            function Paginacao(pagina) {
                pag = pagina;
                //console.log("pagina:" + pag);

                constSelc = (pag * regpag) - 1;
                consLelc = (pag - 1) * regpag;

                selc = ".regItem:gt( " + constSelc + " )"; //take   1-0 | 3-2 | 5-4 |
                lelc = ".regItem:lt( " + consLelc + " )"; //skip
                //console.log("selc:" + selc);
                //console.log("lelc:" + lelc);

                $(".regItem").show();
                $(selc).hide();
                $(lelc).hide();

            }

            $(".page-item").click(function () {
                var pagAtual = $(this).data("pagina");
                if (pagAtual == 0 && pag > 1) {
                    pag--;
                } else if (pagAtual == 99) {
                    pag++;
                }
                else {
                    pag = pagAtual;
                }
                $(".page-item").removeClass("active");
                $(this).addClass("active");

                console.log("pagina:" + pagAtual);

                Paginacao(pag);

            });






            //initial states







            $(".ctaorc").click(function () {
                //selectors
                var empresaSelName = $(this).data("empresa");
                var empresaSelId = $(this).data("empresa-id");

                //esse empresa já foi selecionada
                var empExists = selEmpsName.indexOf(empresaSelName);
                if (empExists > -1) {
                    //console.log(true);
                    selEmpsName.splice(empExists, 1); //remove o item
                    selEmpsId.splice(empExists, 1); //remove o item
                    $(this).text("Pedir Orçamento");
                } else {
                    //console.log(false);
                    selEmpsName.push(empresaSelName); // adiciona o item
                    selEmpsId.push(empresaSelId); // adiciona o item
                    $(this).html("<i class='fa fa-check-square'></i> Selecionado");
                }
                //push

                //console.log(selEmpsName);
                //console.log(selEmpsId);

                $("#hCodeEmpresaIds").val(selEmpsId);

                selEmpresas = "";
                qtdsel = selEmpsName.length;
                for (i = 0; i <= qtdsel-1; i++) {

                    selEmpresas += "<li>" + selEmpsName[i] + "</li>";
                }

                //reports

                //console.log(qtdsel);
                $("#nPedidos").text(qtdsel);
                if (qtdsel > 0) {
                   // $("#Form1 :input").prop("enabled", true);
                    $("#noselAlert").hide();
                    $("#Form1").show();
                } else {
                    //$("#Form1 :input").prop("disabled", true);
                    $("#noselAlert").show();
                    selEmpresas = "<li>Não há empresas selecionadas</li>";
                    $("#Form1").hide();
                }

                $("#listEmpSel").html(selEmpresas);
            });


            $("#listEmpSel").html(selEmpresas);




        });
    </script>

    <style type="text/css">
        .nav-link {
            padding: .25rem 1rem !important;
        }
    </style>

}






<!-- corte -->
<section class="bg-casa-e-reforma shadow">
    <div class="container">
        <div class="row">
            <div class="col-md-12 p-md-0 my-4">
                <h2 id="tituloCat">@ViewBag.Title</h2>


                <select class="custom-select2 w-49 mw-100" id="filtroSubcategoria" required="">
                    <option value="xpot">Selecione o que você precisa</option>
                    <option value="xpot">Arquiteto</option>
                    <option value="xpot">Eletricista</option>
                    <option value="xpot">Bombeiro</option>
                </select>


            </div>
        </div>
    </div>
</section>


<div class="container">

    <!-- for mobile
    <div class="row mt-3 mobile">
        <div class="p-md-0 col-12">
            <select id="" class="w-100">
                <option value="xpot">O que você precisa?</option>
                <option value="xpot">Arquiteto</option>
                <option value="xpot">Eletricista</option>
                <option value="xpot">Bombeiro</option>
            </select>
        </div>
    </div>
        -->


    <div class="row mt-3">
        <div class="col-md-8 p-md-0">
            <ul class="nav nav-pills" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="OfertaLocal" data-toggle="pill" href="#home" role="tab">Empresas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="OfertaWeb" data-toggle="pill" href="#orcamento" role="tab">
                        Pedido de Orçamento <span id="nPedidos" class="badge badge-primary teaser">0</span>
                    </a>
                </li>
                @*<li class="nav-item">
                        <a class="nav-link" id="OfertaWeb" data-toggle="pill" href="#" role="tab">Avaliação</a>
                    </li>*@

            </ul>


            <!-- Tab panes -->
            <div class="tab-content">

                <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                    <div class="target-output" data-template-chosen="a"></div>

                    <!-- Pagination-->
                    <nav aria-label="..." class="mt-3">
                        <ul class="pagination justify-content-center">
                            <li class="page-item disabled" data-pagina="0">
                                <a class="page-link" href="#" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                    <span class="sr-only">Previous</span>
                                </a>
                            </li>
                            <li class="page-item active" data-pagina="1">
                                <span class="page-link">1</span>
                            </li>
                            <li class="page-item" data-pagina="2">
                                <span class="page-link">2</span>
                            </li>
                            <li class="page-item" data-pagina="3">
                                <span class="page-link">3</span>
                            </li>
                            <li class="page-item" data-pagina="99">
                                <a class="page-link" href="#" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </li>
                        </ul>
                    </nav>


                </div>
                <div class="tab-pane fade" id="orcamento" role="tabpanel" aria-labelledby="home-tab">
                    <div class="p-2">
                        <div id="noselAlert" class="alert alert-danger mb-3" role="alert">
                            Você não selecionou nenhuma empresa. <br />
                            Para selecionar, basta clicar em Pedir Orçamento no anúncio da empresa.
                        </div>
                        <div class="">



                            <form id="Form1" action="#" method="post" style="display:none;">
                                <h4 class="mb-3">Pedido de Orçamento</h4>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="empresaNome">Nome</label>
                                        <input type="text" class="form-control" id="nomeUsuario" placeholder="" value="" required="required">

                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="emailEmpresa">Email</label>
                                        <input type="email" class="form-control" id="emailEmpresa" placeholder="" value="" required="required">

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12 mb-3">
                                        <label for="empresaNome">Descreva seu pedido</label>
                                        <textarea class="form-control" id="pedidoUsuario" rows="5"></textarea>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12 mb-3">
                                        <p>Empresas Selecionadas</p>
                                        <ul id="listEmpSel"></ul>

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="selQuando">Quando deseja o serviço</label><br />
                                        <select id="selQuando" name="selQuando" class="custom-select d-block w-100">
                                            <option value="hoje">Hoje (urgente)</option>
                                            <option value="2">Amanhã</option>
                                            <option value="3">Essa semana</option>
                                            <option value="4">Semana que vem</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="empresaBairro">Local do serviço: <span class="font-weight-bold" id="cidSel">Rio de Janeiro</span>-<span class="font-weight-bold" id="ufSel">RJ</span></label>
                                        <input type="text" class="form-control" id="empresaBairro" placeholder="Informe o Bairro" value="" required="required">

                                    </div>

                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        &nbsp;
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <input type="hidden" id="hCodeEmpresaIds" />
                                        <button class="btn btn-primary btn-lg w-100">Enviar Pedido</button>
                                    </div>
                                </div>

                            </form>

                        </div>
                    </div>
                </div>


                <div class="" id="ho">

                    <!-- anuncio -->
                    @*<div class="col-md-12 px-0 mt-2">
                            <div class="reg mr-md-2 p-md-3 p-sm-2">
                                <div class="row">
                                    <div class="col-md-2 col-4 pl-2 pr-0">
                                        <div class="">
                                            <div class="noimgCard">40% Off</div>
                                        </div>
                                    </div>
                                    <div class="col-md-10 col-8 pl-md-4 pl-2">
                                        <div class="f-verde f7r"><span class="font-weight-bold">0,03 Km - Anil</span></div>
                                        <div class="subtitulo">
                                            <a href="/empresa/detalhe">W2 Websites</a>
                                        </div>
                                        <div class="">
                                            <span class="badge badge-success teaser">4,5</span>
                                            <span class="teaser f-verde"><strong>Muito bom</strong> (28 opiniões)</span>
                                        </div>
                                        <div class="f-verde">
                                            <div class="teaser">Criação de Sites Profissionais e Personalizados em Wordpress.</div>
                                            <div class="teaser desktop">Empresa focada em desenvolvimento e construção de sites.</div>
                                        </div>
                                        <div class="mt-0">

                                            <a href="#" class="badge badge-success f7r">Solicitar Orçamento</a>
                                            <span class="f7r f-verde font-weight-bold"><input type="checkbox" class="" value="#" />  Enviar orçamento</span>
                                            <span class="f7r f-verde font-weight-bold desktop">| Desenvolvimento de sites</span>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>*@

                    <!-- anuncio -->



                </div>

            </div>
        </div>

        <div class="col-md-4 pt-5 desktop">
            <div class="sidemenu reg p-0">
                <div class="sidemain p-2">
                    O que você precisa?
                </div>
                <div class="sidetopic">Reformas</div>
                <div class="sidelink"><a href="">Eletricista</a></div>
                <div class="sidelink"><a href="">Bombeiro</a></div>
                <div class="sidelink"><a href="">Eletricista</a></div>
                <div class="sidetopic">Consertos</div>
                <div class="sidelink"><a href="">Televisão</a></div>
                <div class="sidelink"><a href="">Ar Condicionado</a></div>
                <div class="sidelink"><a href="">Eletronica</a></div>
            </div>

            <!--adsense-->

        </div>
    </div>


</div>

<!-- mustache -->

<script id="mustacheTempalte_a" type="text/template">
    <div class="item">
        {{#cardEmpresaShow}}
        <div class="col-md-12 px-0 mt-2 regItem">
            <div class="reg2 mr-md-2 p-md-3 p-sm-2">
                <div class="row">
                    <div class="col-md-2 col-4 pl-2 pr-0">
                        <div class="">
                            <div class="imgCard"><img src="/Content/img/{{ImagemUrl}}" alt="" class="imgCard rounded" /></div>
                        </div>
                    </div>
                    <div class="col-md-10 col-8 pl-md-3 pl-2">
                        @*<div class="f-verde f7r"><span class="font-weight-bold">0,03 Km - Anil</span></div>*@
                        <div class="subtitulo">
                            <a href="#">{{NomeEmpresa}}</a>
                        </div>
                        <div class="">
                            <span class="badge badge-success teaser">{{Avaliacao}}</span>
                            <span class="teaser f-verde"><strong>{{AvaliacaoLabel}}</strong> ({{QtdAvaliacoes}} opiniões)</span>
                        </div>
                        <div class="f-verde">
                            <div class="teaser">{{Texto1}}</div>
                            <div class="teaser desktop">{{Texto2}}</div>
                        </div>
                        <div class="mt-0">

                            <span class="badge badge-success f7r ctaorc" data-empresa="{{NomeEmpresa}}" data-empresa-id="{{CodeEmpresa}}">Pedir Orçamento</span>
                            @*<span class="f7r f-verde font-weight-bold"><input type="checkbox" class="" value="#" />  Enviar orçamento</span>*@
                            <span class="f7r f-verde font-weight-bold desktop">| {{EmpSubcategorias}}</span>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        {{/cardEmpresaShow}}
    </div>
</script>

<script id="mustacheTempalte_b" type="text/template">
    <div class="item">
        {{#shows}}
        <ul>
            <li><strong>Title:</strong> {{title}}</li>
            <li><strong>Description:</strong> {{{description}}}</li>
            <li><strong>Video:</strong> {{video}}</li>
            <li><strong>Category:</strong> {{category}}</li>
        </ul>
        {{/shows}}
    </div>
</script>

@*<script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>*@
@*<script src='https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.7.2/mustache.min.js'></script>*@
<script src="~/Scripts/mustache.min.js"></script>
<script>
    var targetContainer = $(".target-output"),
        templateDefined = $(".target-output").data("template-chosen"),
        template = $("#mustacheTempalte_" + templateDefined).html();

   

    var inputApi = {
        "catId": 1,
        "subcatId": 0,
        "uf": null,
        "cid": null,
        "t": 0,
        "s": 0
    }
    $.post("/api/anuncio/listaCards", inputApi, function (result) {
        var cardEmpresaShow = result;
        console.log(result);
        var html = Mustache.to_html(template, cardEmpresaShow);

        $(targetContainer).html(html);
    });

    //var shows = {
    //    "shows": [
    //        {
    //            "CodeEmpresa": "01",
    //            "ImagemUrl": "empresa1/promo-100.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Elétrica Xpto - 1",
    //            "Avaliacao": "4,5",
    //            "AvaliacaoLabel": "Muito Bom",
    //            "QtdAvaliacoes": "35",
    //            "Texto1": "Há mais de dez anos na área de eletricidade.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Eletricista"
    //        },

    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa99/promo-20.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Luzan LTDA - 2",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Há mais de dez anos na área de eletricidade.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Eletricista, Encanador, Pedreiro, Serviços Gerais"
    //        },
    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa7/promo-131.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Aulas Paticulares - Pedro Coppelli - 3",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Aulas de Fis.,Qui., Mat., Port.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Professor Particular"
    //        },
    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa7/promo-131.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Aulas Paticulares - Pedro Coppelli - 4",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Aulas de Fis.,Qui., Mat., Port.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Professor Particular"
    //        },
    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa7/promo-131.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Aulas Paticulares - Pedro Coppelli - 5",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Aulas de Fis.,Qui., Mat., Port.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Professor Particular"
    //        },
    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa7/promo-131.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Aulas Paticulares - Pedro Coppelli - 6",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Aulas de Fis.,Qui., Mat., Port.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Professor Particular"
    //        },
    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa7/promo-131.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Aulas Paticulares - Pedro Coppelli - 7",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Aulas de Fis.,Qui., Mat., Port.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Professor Particular"
    //        },
    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa7/promo-131.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Aulas Paticulares - Pedro Coppelli - 8",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Aulas de Fis.,Qui., Mat., Port.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Professor Particular"
    //        },
    //        {
    //            "CodeEmpresa": "02",
    //            "ImagemUrl": "empresa7/promo-131.jpg",
    //            "lnkEmpresa": "/empresa/detalhe",
    //            "NomeEmpresa": "Aulas Paticulares - Pedro Coppelli - 9",
    //            "Avaliacao": "3,5",
    //            "AvaliacaoLabel": "Bom",
    //            "QtdAvaliacoes": "45",
    //            "Texto1": "Aulas de Fis.,Qui., Mat., Port.",
    //            "Texto2": "Agende hoje mesmo uma visita conosco.",
    //            "Categorias": "Professor Particular"
    //        }
    //    ]
    //};




    
//# sourceURL=pen.js
</script>
